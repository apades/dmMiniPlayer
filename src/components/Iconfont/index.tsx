import {
  memo,
  type CSSProperties,
  type FC,
  useEffect,
  useState,
  forwardRef,
} from 'react'
import { createPortal } from 'react-dom'

let div = document.createElement('div')
document.body.appendChild(div)

const svgMap = {
  iconicon_player_volume: (
    <svg id="iconicon_player_volume" viewBox="0 0 1024 1024">
      <path d="M470.016 34.176c56.768-45.696 100.928-21.184 100.928 52.288V887.04c0 70.272-44.16 91.52-94.592 45.76l-227.008-192.768H124.8c-70.976 0-124.544-58.816-124.544-129.088v-263.04C0.256 277.696 56.96 218.88 124.8 218.88h118.208L470.016 34.176z m231.744 660.032a36.16 36.16 0 0 1-29.952-14.72c-20.48-21.184-20.48-45.696 0-63.68 74.112-76.8 74.112-192.768 0-269.568-20.48-21.248-20.48-45.76 0-63.744 20.48-21.184 44.16-21.184 64.64 0 115.072 107.84 115.072 282.688 0 392.128-17.28 16.32-20.48 19.584-34.688 19.584z m124.544 73.536c-20.48-21.248-20.48-45.76 0-63.744a314.56 314.56 0 0 0 0-437.76c-20.48-21.312-20.48-45.824 0-63.744 20.48-21.248 44.16-21.248 64.64 0 74.112 76.8 118.272 174.784 118.272 276.096 0 101.248-44.16 205.824-118.272 276.096-6.272 6.528-20.48 14.72-29.952 14.72-14.208 9.792-26.816 1.6-34.688-1.664z"></path>
    </svg>
  ),
  iconicon_player_pause: (
    <svg id="iconicon_player_pause" viewBox="0 0 1024 1024">
      <path d="M253.44 984.96a120.064 120.064 0 0 1-119.808-119.68V158.72c0-65.792 53.952-119.68 119.808-119.68 65.92 0 119.808 53.888 119.808 119.68v706.56c0 65.792-53.888 119.68-119.808 119.68z m517.12 0a120.064 120.064 0 0 1-119.808-119.68V158.72c0-65.792 53.888-119.68 119.808-119.68 65.92 0 119.808 53.888 119.808 119.68v706.56c0 65.792-53.952 119.68-119.808 119.68z"></path>
    </svg>
  ),
  iconicon_player_play: (
    <svg id="iconicon_player_play" viewBox="0 0 1088 1024">
      <path d="M869.12 567.04l-592.576 378.24a93.888 93.888 0 0 1-131.072-31.168 99.072 99.072 0 0 1-14.4-51.52V161.408c0-53.76 42.624-97.408 95.168-97.408 17.792 0 35.2 5.12 50.304 14.72l592.64 378.24a65.792 65.792 0 0 1 0 110.08z"></path>
    </svg>
  ),
  iconMute1: (
    <svg id="iconMute1" viewBox="0 0 1024 1024">
      <path d="M570.88 86.464V887.04c0 70.272-44.096 91.52-94.528 45.76L249.344 740.032H124.8C53.824 740.032 0.256 681.216 0.256 610.944v-263.04C0.256 277.696 56.96 218.88 124.8 218.88h118.208L470.016 34.176c56.768-45.696 100.928-21.184 100.928 52.288z m391.424 107.52a57.6 57.6 0 0 1 27.904 76.544l-99.584 213.44 99.584 213.504a57.6 57.6 0 1 1-104.448 48.64l-58.688-125.888-58.688 125.952A57.6 57.6 0 0 1 664 697.536l99.52-213.568L664 270.528a57.6 57.6 0 1 1 104.384-48.64l58.688 125.824 58.688-125.888a57.6 57.6 0 0 1 76.544-27.84z"></path>
    </svg>
  ),
  input: (
    <svg id="input" viewBox="0 0 1024 1024">
      <path d="M341.333333 896v-85.333333h128V213.333333H341.333333V128h341.333334v85.333333h-128v597.333334h128v85.333333H341.333333zM770.133333 300.8L981.333333 512l-211.2 211.2-60.330666-60.330667L860.672 512l-150.869333-150.869333L770.133333 300.8z m-516.266666 0l60.330666 60.330667L163.328 512l150.869333 150.869333L253.866667 723.2 42.666667 512l211.2-211.2z"></path>
    </svg>
  ),
  danmaku_close: (
    <svg id="danmaku_close" viewBox="0 0 1024 1024">
      <path d="M217.8 319.89h-48c-35.9 0-65-29.1-65-65s29.1-65 65-65h48c35.9 0 65 29.1 65 65s-29.1 65-65 65zM714.8 319.89h-322c-35.9 0-65-29.1-65-65s29.1-65 65-65h322c35.9 0 65 29.1 65 65s-29.1 65-65 65zM403.8 579.89h-234c-35.9 0-65-29.1-65-65s29.1-65 65-65h234c35.9 0 65 29.1 65 65s-29.1 65-65 65zM252.8 838.89h-83c-35.9 0-65-29.1-65-65s29.1-65 65-65h83c35.9 0 65 29.1 65 65s-29.1 65-65 65zM425.8 838.89h-1c-35.9 0-65-29.1-65-65s29.1-65 65-65h1c35.9 0 65 29.1 65 65s-29.1 65-65 65zM717.73 398.22c-122.04 0-220.97 98.93-220.97 220.97 0 122.04 98.93 220.97 220.97 220.97 122.04 0 220.97-98.93 220.97-220.97 0.01-122.04-98.93-220.97-220.97-220.97zM822 554.48l-165.25 171.2c-5.9 6.12-13.77 9.19-21.65 9.19-7.52 0-15.05-2.8-20.89-8.44-11.95-11.54-12.29-30.58-0.75-42.54l165.25-171.2c11.54-11.96 30.58-12.29 42.54-0.75 11.95 11.55 12.29 30.59 0.75 42.54z"></path>
    </svg>
  ),
  danmaku_open: (
    <svg id="danmaku_open" viewBox="0 0 1024 1024">
      <path d="M221.58 319.89h-48c-35.9 0-65-29.1-65-65s29.1-65 65-65h48c35.9 0 65 29.1 65 65s-29.1 65-65 65zM718.58 319.89h-322c-35.9 0-65-29.1-65-65s29.1-65 65-65h322c35.9 0 65 29.1 65 65s-29.1 65-65 65zM407.58 579.89h-234c-35.9 0-65-29.1-65-65s29.1-65 65-65h234c35.9 0 65 29.1 65 65s-29.1 65-65 65zM256.58 838.89h-83c-35.9 0-65-29.1-65-65s29.1-65 65-65h83c35.9 0 65 29.1 65 65s-29.1 65-65 65zM429.58 838.89h-1c-35.9 0-65-29.1-65-65s29.1-65 65-65h1c35.9 0 65 29.1 65 65s-29.1 65-65 65zM713.96 396.72c-122.04 0-220.97 98.93-220.97 220.97s98.93 220.97 220.97 220.97 220.97-98.93 220.97-220.97S836 396.72 713.96 396.72zM837.9 561.91L689.88 715.26a30.078 30.078 0 0 1-21.38 9.19h-0.27c-7.97 0-15.63-3.17-21.27-8.81l-56.57-56.57c-11.75-11.75-11.75-30.79 0-42.54s30.79-11.75 42.54 0l34.92 34.91 126.76-131.32c11.54-11.96 30.58-12.29 42.54-0.75 11.95 11.54 12.29 30.58 0.75 42.54z"></path>
    </svg>
  ),
  danmaku_settings: (
    <svg id="danmaku_settings" viewBox="0 0 1024 1024">
      <path d="M226.58 320.39h-48c-35.9 0-65-29.1-65-65s29.1-65 65-65h48c35.9 0 65 29.1 65 65s-29.1 65-65 65zM723.58 320.39h-322c-35.9 0-65-29.1-65-65s29.1-65 65-65h322c35.9 0 65 29.1 65 65s-29.1 65-65 65zM402.58 580.39h-224c-35.9 0-65-29.1-65-65s29.1-65 65-65h224c35.9 0 65 29.1 65 65s-29.1 65-65 65zM251.58 839.39h-73c-35.9 0-65-29.1-65-65s29.1-65 65-65h73c35.9 0 65 29.1 65 65s-29.1 65-65 65zM424.58 839.39h-1c-35.9 0-65-29.1-65-65s29.1-65 65-65h1c35.9 0 65 29.1 65 65s-29.1 65-65 65zM954.82 588.59l-93.4-161.78a59.189 59.189 0 0 0-51.27-29.6h-186.8a59.201 59.201 0 0 0-51.27 29.6l-93.4 161.78a59.225 59.225 0 0 0 0 59.2l93.4 161.78a59.189 59.189 0 0 0 51.27 29.6h186.81c21.15 0 40.69-11.28 51.27-29.6l93.4-161.78a59.2 59.2 0 0 0-0.01-59.2z m-238.07 95.78c-36.55 0-66.18-29.63-66.18-66.18 0-36.55 29.63-66.18 66.18-66.18 36.55 0 66.18 29.63 66.18 66.18 0 36.55-29.63 66.18-66.18 66.18z"></path>
    </svg>
  ),
  file: (
    <svg id="file" viewBox="0 0 1024 1024">
      <path d="M607.994 0c10.23936 0 20.030748 3.1998 28.15824 9.151428l5.759641 4.927692 278.382601 278.382601a47.997 47.997 0 0 1 13.43916 26.366352l0.63996 7.551528v428.773202c0 37.373664 0 68.219736-2.047872 93.43416-2.175864 26.174364-6.71958 50.364852-18.366852 73.147429-17.91888 35.1978-46.589088 63.868008-81.786889 81.786888-22.782576 11.647272-46.973064 16.254984-73.147428 18.366852-20.990688 1.727892-45.949128 1.983876-75.259296 2.047872H364.745203c-37.309668 0-68.15574 0-93.370164-2.047872-26.174364-2.175864-50.364852-6.71958-73.147428-18.366852a187.188301 187.188301 0 0 1-81.786889-81.786888c-11.647272-22.782576-16.190988-46.973064-18.366852-73.147429a991.938004 991.938004 0 0 1-2.047872-75.259296V250.608337c0-29.310168 0.31998-54.268608 2.047872-75.259296 2.175864-26.174364 6.71958-50.364852 18.366852-73.147429 17.91888-35.1978 46.589088-63.868008 81.786889-81.786888 22.782576-11.647272 46.973064-16.190988 73.147428-18.366852C292.365727 0.31998 317.324167 0.063996 346.634335 0H607.994z m-47.997 95.994H339.210799a810.189363 810.189363 0 0 0-59.964252 1.727892c-20.286732 1.663896-30.462096 4.671708-37.43766 8.191488a91.1943 91.1943 0 0 0-39.869508 39.869509c-3.51978 7.03956-6.527592 17.150928-8.191488 37.43766-1.27992 15.551028-1.5999 34.621836-1.663896 59.964252v537.566402c0 25.342416 0.383976 44.413224 1.663896 60.028248 1.663896 20.222736 4.671708 30.3981 8.191488 37.373664 8.767452 17.150928 22.71858 31.102056 39.869508 39.869509 7.03956 3.51978 17.150928 6.527592 37.43766 8.191488 18.174864 1.471908 41.085432 1.663896 73.147428 1.727892h311.276546c39.741516 0 66.683832 0 87.546528-1.727892 20.222736-1.663896 30.3981-4.671708 37.373664-8.191488 17.150928-8.767452 31.102056-22.71858 39.869508-39.869509 3.51978-7.03956 6.527592-17.150928 8.191488-37.43766 1.27992-15.551028 1.5999-34.621836 1.663896-59.964252l0.063996-406.374602h-157.686144c-11.647272 0-23.102556 0-32.829948-0.767952a95.35404 95.35404 0 0 1-36.349729-9.535404 94.3941 94.3941 0 0 1-41.213424-41.213424 95.35404 95.35404 0 0 1-9.535404-36.349728c-0.767952-9.727392-0.767952-21.11868-0.767952-32.829948V95.994zM399.68702 476.770202c22.07862 0 41.5974 2.87982 58.23636 8.95944 16.510968 6.07962 31.934004 15.03906 46.333104 26.87832l7.35954 6.143616-47.613024 57.788388-7.423536-6.015624a85.562652 85.562652 0 0 0-55.100556-20.47872 50.87682 50.87682 0 0 0-43.261297 22.654584c-10.943316 15.35904-17.27892 39.67752-17.27892 74.619337 0 34.941816 6.335604 59.132304 17.27892 74.171364 10.815324 14.527092 25.342416 21.75864 44.541217 21.75864 12.543216 0 22.71858-2.175864 30.846072-6.143616 8.95944-4.351728 18.87882-10.687332 29.75814-19.262796l7.551528-6.015624 43.901256 56.380476-5.823636 6.015624c-29.182176 29.75814-66.171864 44.541216-110.201112 44.541216-29.566152 0-56.060496-6.527592-79.291045-19.83876a137.591401 137.591401 0 0 1-53.884632-59.068308c-12.927192-26.174364-19.1988-57.148428-19.1988-92.538216 0-34.55784 6.3996-64.95594 19.710768-90.874321 13.183176-25.726392 31.550028-45.629148 55.100556-59.324292a153.398413 153.398413 0 0 1 78.459097-20.350728z m265.839385 0c22.142616 0 41.5974 2.87982 58.300356 8.95944 16.510968 6.07962 31.934004 15.03906 46.269108 26.87832l7.423536 6.143616-47.613024 57.788388-7.423536-6.015624a85.562652 85.562652 0 0 0-55.164552-20.47872 50.87682 50.87682 0 0 0-43.197301 22.654584c-11.007312 15.35904-17.27892 39.67752-17.27892 74.619337 0 34.941816 6.271608 59.132304 17.27892 74.171364 10.751328 14.527092 25.27842 21.75864 44.541217 21.75864 12.47922 0 22.654584-2.175864 30.846072-6.143616 8.95944-4.351728 18.87882-10.687332 29.694144-19.262796l7.615524-6.015624 43.901256 56.380476-5.887632 6.015624c-29.11818 29.75814-66.107868 44.541216-110.137116 44.541216-29.566152 0-56.060496-6.527592-79.355041-19.83876a137.591401 137.591401 0 0 1-53.884632-59.068308c-12.863196-26.174364-19.1988-57.148428-19.1988-92.538216 0-34.55784 6.463596-64.95594 19.710768-90.874321 13.183176-25.726392 31.550028-45.629148 55.164552-59.324292A153.398413 153.398413 0 0 1 665.590401 476.770202z m-9.535404-312.940441v88.31448c0 13.183176 0 20.542716 0.447972 25.854384 5.247672 0.383976 12.607212 0.383976 25.790388 0.383976h88.31448l-114.55284-114.55284z"></path>
    </svg>
  ),
  subtitle: (
    <svg id="subtitle" viewBox="0 0 1024 1024">
      <path d="M392.825905 394.044952c22.308571 0 42.25219 3.925333 59.952762 11.751619 16.554667 7.314286 30.45181 17.603048 41.74019 30.915048l-39.155809 35.425524c-16.262095-18.212571-35.961905-27.501714-58.977524-27.501714-14.09219 0-26.770286 3.096381-37.961143 9.386666a65.511619 65.511619 0 0 0-26.014476 26.575238c-6.144 11.410286-9.167238 24.429714-9.167238 38.960762 0 14.531048 3.023238 27.550476 9.167238 38.960762 6.144 11.410286 14.848 20.309333 26.014476 26.575238 11.215238 6.290286 23.893333 9.386667 37.961143 9.386667 23.015619 0 42.715429-9.264762 59.001905-27.501714l39.131428 35.425523a114.590476 114.590476 0 0 1-41.74019 30.939429c-17.700571 7.801905-37.668571 11.751619-59.952762 11.751619-25.502476 0-48.274286-5.38819-68.388572-16.091429a119.759238 119.759238 0 0 1-47.37219-44.617142c-11.459048-19.017143-17.212952-40.594286-17.212953-64.828953 0-24.234667 5.753905-45.83619 17.212953-64.853333a119.759238 119.759238 0 0 1 47.37219-44.617143c20.114286-10.678857 42.910476-16.067048 68.388572-16.067048zM720.944762 405.796571c-17.67619-7.801905-37.64419-11.751619-59.928381-11.751619-25.502476 0-48.274286 5.36381-68.388571 16.067048a119.759238 119.759238 0 0 0-47.372191 44.617143c-11.459048 19.017143-17.212952 40.594286-17.212952 64.853333 0 24.210286 5.753905 45.787429 17.212952 64.804572a119.759238 119.759238 0 0 0 47.372191 44.617142c20.138667 10.703238 42.910476 16.091429 68.388571 16.091429 22.308571 0 42.25219-3.949714 59.952762-11.751619a114.590476 114.590476 0 0 0 41.74019-30.939429l-39.155809-35.425523c-16.262095 18.212571-35.961905 27.501714-58.977524 27.501714A76.239238 76.239238 0 0 1 626.614857 585.142857a65.511619 65.511619 0 0 1-26.014476-26.575238c-6.144-11.459048-9.167238-24.454095-9.167238-38.985143 0-14.531048 3.023238-27.550476 9.167238-38.960762a65.511619 65.511619 0 0 1 26.014476-26.575238 76.214857 76.214857 0 0 1 37.961143-9.386666c23.015619 0 42.715429 9.289143 59.001905 27.501714l39.131428-35.425524a114.639238 114.639238 0 0 0-41.74019-30.915048z"></path>
      <path d="M106.666667 202.678857C106.666667 185.002667 121.002667 170.666667 138.678857 170.666667h746.666667c17.65181 0 31.98781 14.336 31.987809 32.01219v618.642286c0 17.67619-14.336 32.01219-32.01219 32.01219H138.703238a31.98781 31.98781 0 0 1-32.01219-32.01219V202.703238z m58.660571 591.969524H858.697143V229.351619H165.302857v565.345524z"></path>
    </svg>
  ),
} as const

function withPortal<T>(
  Components: React.FC<T>,
): React.FC<T & { container: Element }> {
  Components = memo(Components) as any
  return (props: T & { container: Element }) => {
    if (props.container) {
      return createPortal(<Components {...props} />, props.container)
    }

    return <Components {...props} />
  }
}
type Type = keyof typeof svgMap
type Props = React.DetailedHTMLProps<
  React.HTMLAttributes<HTMLSpanElement>,
  HTMLSpanElement
> & {
  type: Type
  size?: CSSProperties['fontSize']
}

const Iconfont: FC<Props> = (props, ref) => {
  return (
    <svg
      width="1em"
      height="1em"
      fill="currentColor"
      aria-hidden="true"
      focusable="false"
      className={`component-icon ${props.className ?? ''} ${props.type}`}
      style={{
        color: props.color,
        fontSize: props.size,
        ...(props.style ?? {}),
      }}
    >
      {(svgMap as any)[props.type]}
    </svg>
  )
}

export default Iconfont
